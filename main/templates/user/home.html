{% extends 'user/base.html' %}

{% block title %}{{ company.company_name|default:"Talent Solutions" }} - Find Your Dream Job{% endblock %}

{% block extra_css %}
<style>
    .reveal {
        opacity: 0;
        transform: translateY(30px);
        transition: opacity 0.8s ease, transform 0.8s ease;
    }

    .reveal.active {
        opacity: 1;
        transform: translateY(0);
    }

    .reveal-children>* {
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.6s ease, transform 0.6s ease;
    }

    .reveal-children.active>*:nth-child(1) {
        transition-delay: 0.1s;
    }

    .reveal-children.active>*:nth-child(2) {
        transition-delay: 0.2s;
    }

    .reveal-children.active>*:nth-child(3) {
        transition-delay: 0.3s;
    }

    .reveal-children.active>*:nth-child(4) {
        transition-delay: 0.4s;
    }

    .reveal-children.active>*:nth-child(5) {
        transition-delay: 0.5s;
    }

    .reveal-children.active>*:nth-child(6) {
        transition-delay: 0.6s;
    }

    .reveal-children.active>* {
        opacity: 1;
        transform: translateY(0);
    }
</style>
{% endblock %}

{# IMPORTANT: keep this as gradient-bg so navbar text can switch dark/light per section properly #}
{% block body_class %}gradient-bg{% endblock %}
{% block main_class %}{% endblock %}


{% block content %}
{% include "user/components/hero.html" %}
{% include "user/components/about.html" %}
{% include "user/components/jobs.html" %}
{% include "user/components/team.html" %}
{% include "user/components/services.html" %}
{% include "user/components/contact.html" %}

{% endblock %}

{% block footer %}{% endblock %}

{% block extra_js %}
<script>
    // ===== Scroll reveal animation =====
    function revealOnScroll() {
        const reveals = document.querySelectorAll('.reveal, .reveal-children');
        const windowHeight = window.innerHeight;

        reveals.forEach(el => {
            const top = el.getBoundingClientRect().top;
            if (top < windowHeight - 150) el.classList.add('active');
        });
    }

    window.addEventListener('scroll', revealOnScroll);
    window.addEventListener('load', revealOnScroll);

    // ===== Jobs carousel =====
    (function () {
        const track = document.getElementById('carousel-track');
        const prevBtn = document.getElementById('carousel-prev');
        const nextBtn = document.getElementById('carousel-next');
        if (!track || !prevBtn || !nextBtn) return;

        let currentIndex = 0;

        function getCardWidth() {
            const card = track.children[0];
            if (!card) return 0;
            return card.offsetWidth + 16; // gap-4 = 16px
        }

        function visibleCount() {
            return Math.floor(track.parentElement.offsetWidth / getCardWidth()) || 1;
        }

        function maxIndex() {
            return Math.max(0, track.children.length - visibleCount());
        }

        function updateCarousel() {
            track.style.transform = 'translateX(-' + (currentIndex * getCardWidth()) + 'px)';
            prevBtn.classList.toggle('hidden', currentIndex === 0);
            nextBtn.classList.toggle('hidden', currentIndex >= maxIndex());
        }

        window.carouselSlide = function (dir) {
            currentIndex = Math.max(0, Math.min(currentIndex + dir, maxIndex()));
            updateCarousel();
        };

        updateCarousel();
        window.addEventListener('resize', () => {
            currentIndex = Math.min(currentIndex, maxIndex());
            updateCarousel();
        });
    })();
</script>
{% endblock %}